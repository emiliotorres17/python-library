#!/usr/bin/env python3
"""========================================================================
Purpose:
    The purpose of this subroutine is to calculate the D term in enstrophy
    transport equation.

Author:
    Emilio Torres
========================================================================"""
#=========================================================================#
# Preamble                                                                #
#=========================================================================#
#-------------------------------------------------------------------------#
# Python packages                                                         #
#-------------------------------------------------------------------------#
import os
import sys
from subprocess import call
import numpy as np
#=========================================================================#
# User defined functions                                                  #
#=========================================================================#
#-------------------------------------------------------------------------#
# Gradient tool                                                           #
#-------------------------------------------------------------------------#
def alpha_grad(
        tau1,                       # 1st component of SGS
        tau2,                       # 2nd component of SGS
        tau3,                       # 3rd component of SGS
        dx      = False):           # spatial step size

    """ Calculating the gradient terms in the alpha term """
    #---------------------------------------------------------------------#
    # Spatial step size                                                   #
    #---------------------------------------------------------------------#
    if dx is False:
        pi  = np.pi
        dx  = (2.0*pi)/64
    #---------------------------------------------------------------------#
    # Gradients                                                           #
    #---------------------------------------------------------------------#
    a       = np.gradient(tau1, dx, edgeorder=2)[0]
    b       = np.gradient(tau2, dx, edgeorder=2)[1]
    c       = np.gradient(tau3, dx, edgeorder=2)[2]
    #---------------------------------------------------------------------#
    # Alpha term                                                          #
    #---------------------------------------------------------------------#
    alpha   = a + b + c
    #---------------------------------------------------------------------#
    # Clearing variables                                                  #
    #---------------------------------------------------------------------#
    del a
    del b
    del c

    return alpha
#-------------------------------------------------------------------------#
# Alpha term                                                              #
#-------------------------------------------------------------------------#
def alpha_func(
        tau11,               # 11-subgrid stress component
        tau12,               # 12-subgrid stress component
        tau13,               # 13-subgrid stress component
        tau22,               # 22-subgrid stress component
        tau23,               # 23-subgrid stress component
        tau33):               # 33-subgrid stress component

    """ Calculating the alpha term in the SGS enstrophy transport
        equation. """
    #---------------------------------------------------------------------#
    # Alpha terms                                                         #
    #---------------------------------------------------------------------#
    a1      = alpha_grad(tau11, tau12, tau13)
    a2      = alpha_grad(tau12, tau22, tau23)
    a3      = alpha_grad(tau13, tau23, tau33)

    return (a1, a2, a3)
#-------------------------------------------------------------------------#
# 
#-------------------------------------------------------------------------#
